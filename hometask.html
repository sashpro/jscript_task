<html>
<head>
    <meta charset="utf-8">
    <title>Домашка</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

</head>
<body>
<div>
    <ul>
        <li>
            <div ><br>
                <label>Строка </label>
                <input type="text" placeholder="введите строку" id="dz1str">
                <br><br>
                <label>Отбросить</label>
                <input type="text" placeholder="лишнее" id="dz1del">
                <br><br>
                <div id="answer1">

                </div>
                <br>
                <input type="button" value="Обработать" onclick="parseStr()">

            </div>
        </li>
        <p><p>
        <li>
            <div>
                <br>
                <form action="">
                    <input class="ch_filter" id='ch1' name='filter' type="radio" value="1">Студентов (от 18 до 24 лет)<br>
                    <input class="ch_filter" id='ch2' name='filter'  type="radio" value="2">Всех с зарплатой меньше $1000<br>
                    <input class="ch_filter" id='ch3' name='filter'  type="radio" value="3">Женщин старше 35 лет<br>
                    <input class="ch_filter" id='ch4' name='filter'  type="radio" value="4">Женатых мужчин<br>
                    <input class="ch_filter" id='ch5' name='filter'  type="radio" value="5">Всех незамужних женщин возрастом до 35 и всех женатых мужчин с зарплатой больше $2000<br>
                    <input class="ch_filter" id='ch6' name='filter'  type="radio" value="6">Всех, у кого есть дети<br>
                    <input class="ch_filter" id='ch7' name='filter'  type="radio" value="7">Всех неженатых мужчин, у которых есть дети младше 5 лет<br>
                </form>
            </div>
            <div id="answer2">

            </div>
        </li>
        <li>
            <div>
                <input type="text" placeholder="1-я матрица" id="matrix1" class="matrix">     <input type="text" placeholder="2-я матрица" id="matrix2" class="matrix">
                </div>
            <br><br>
            <div id="answer3">

            </div><br>
            <input type="button" value="Сложить" onclick="summatrix()">
        </li>
        <li>
            <div>
                <input type="text" placeholder="имя пользователя" id="usr_name" class="matrix">
                </div>
            <br><br>
            <div id="answer4">

            </div><br>
            <input type="button" value="Изменить" onclick="changeName()">
        </li>
    </ul>
</div>

    <script>
        public class usr{
            private string name;

            public user(name='Petr'){
                this.name = name;
            }
            public string getName(){
                return this.name;
            }

            public void setName(name){

                this.name = name;
                 alert(this.name);
             }
    }

    let user = new usr();
    function changeName() {

        var before = user.getName();
        user.setName(document.getElementById('usr_name').val())

        alert('имя до: '+before+'   '+'имя после: '+ user.getName())
    }
    </script>
</body>
<script>
    $(".ch_filter").click(CreateArray)

    //суммир матриц
    function summatrix(){
        m1 = ( document.getElementById('matrix1').val());
        m1 = document.getElementById('matrix2');
        console.log(m1.split('],['));
    }

    function parseStr(){
        splarr = $("#dz1str").val().split(', ');
        ind = splarr.indexOf($("#dz1del").val());
        if (ind>0) splarr.splice(ind,1);
        $("#answer1").text(splarr.join(', '));
        console.log(ind, splarr);
    }



    function CreateArray(){

        var params = [["Женя",45,"male",30000,true,[["Гена",3,"male"]]],
            ["Костя",34,"male",432534,true,[]],
            ["Гена",54,"male",6547,false,[["Джон",7,"male"],["Глафила",4,"female"]]],
            ["Петр",22,"male",6534,false, [["Одя",12,"female"]]],
            ["Джон",77,"male",998,true,[["Сельвестра",2,"female"],["Петр",13,"male"]]],
            ["Клара",55,"female",56543,false,[["Петр",15,"male"]]],
            ["Глафила",33,"female",23233,false, [["Роза",8,"female"]]],
            ["Роза",43,"female",98232,true,[]],
            ["Одя",32,"female",87433,false,[["Клара",17,"female"], ["Роза",8,"female"]]],
            ["Сельвестра",66,"female", 45342, true,[["Костя",14,"male"]]]];



        var persons = [];
        for (var i=0; i<10; i++){
            persons[i] = new Object();

            persons[i].name = params[i][0];
            persons[i].age = params[i][1];
            persons[i].sex = params[i][2];
            persons[i].salary = params[i][3];
            persons[i].married = params[i][4];
            persons[i].children = [];
            for (var j=0; j<params[i][5].length; j++){
                persons[i].children[j] = new Object();
                persons[i].children[j].name = params[i][5][j][0];
                persons[i].children[j].age = params[i][5][j][1];
                persons[i].children[j].sex = params[i][5][j][2];
            }


        }
        //console.log(persons);
        newfilter(persons, clb)
    }

    //callback
    function clb(item){
        //console.log(items);
        switch ($('input[name=filter]:checked').attr('value')){
            case '1':
                    if ((item.age>=18)&&(item.age<=24))
                        return true;
                break;
            case '2':
                    if (item.salary<1000)
                            return true;
                break;
            case '3':
                    if ((item.sex == 'female')&&(item.age>35))
                            return true;
                break;
            case '4':
                    if ((item.sex == 'male')&&(item.married == true ))
                            return true;
                break;
            case '5':
                    if (((item.sex == 'female')&&(item.age<35)&&(item.married ==false)) ||((item.sex == 'male')&&(item.salary>2000)&&(item.married ==true)) )
                            return true;
                break;
            case '6':
                    if ((item.children.length>0))
                            return true;
                break;
            case '7':
                    if ((item.sex == 'male')&&(item.married ==false))
                    {
                        var ch=0;
                        for (var i=0;i<item.children.length; i++)
                            if (item.children[i].age<5) ch++;
                        if (ch)  return true;
                    }
                break;

        }
        return false;

    }

    function newfilter(persons, callback){
        var sorted_persons = [];
        var j=0;
        for (var i = 0; i< persons.length; i++) {
            if (callback(persons[i])){
                sorted_persons[j] = new  Object();
                sorted_persons[j++] = persons[i];
            }


        }

        show_result(sorted_persons);
    }


    //вывод отфильтрованных данных
    function show_result(data){
        elem = document.getElementById('answer2');
        elem.innerHTML="<table><tbody>";
        var html_str = '';

        for (var i = 0; i< data.length; i++){
            elem.innerHTML += "<tr><td><b>"+(i+1)+"</b></td><td><ul type=\"circle\">";
           // var s = JSON.stringify(data[i]);
            //console.log(s);
            var s = data[i];
            elem.innerHTML += "<li><b>Name:</b> "+s.name+"</li>";
            elem.innerHTML += "<li><b>Age: </b>"+s.age+"</li>";
            elem.innerHTML += "<li><b>Sex:</b> "+s.sex+"</li>";
            elem.innerHTML += "<li><b>Salary: </b>"+s.salary+"</li>";
            elem.innerHTML += "<li><b>Married: </b>"+(s.married?"yes":'no')+"</li>";
             elem.innerHTML += "<li><b>Children:</b>"+(s.children.length?'':'-')+" </li>";
             elem.innerHTML += "</ul></td><td></td></tr>";
             for (var j = 0; j< s.children.length; j++) {
                elem.innerHTML += "<tr><td><b>" + (j + 1) + "</b></td><td><ul type='square'>";
                elem.innerHTML += "<li><b>Name:</b> "+s.children[j].name+"</li>";
                elem.innerHTML += "<li><b>Age: </b>"+s.children[j].age+"</li>";
                elem.innerHTML += "<li><b>Sex:</b> "+s.children[j].sex+"</li>";

                elem.innerHTML += "</ul></td></tr>";
            }



            //console.log(sorted_persons);
        }
        elem.innerHTML+="</tbody></table>";
    }



</script>
</html>